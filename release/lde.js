var EventEmitter,Feedback,InputStructure,InputTree,Structure,deserializeIfNeeded,expectedArgumentCount,feedback,functions,isInTheInputTree,slice=[].slice;"undefined"!=typeof require&&null!==require?(Structure=require("./structure").Structure,InputStructure=require("./input-structure").InputStructure):"undefined"!=typeof WorkerGlobalScope&&null!==WorkerGlobalScope?(importScripts("structure.js"),importScripts("input-structure.js")):null!=("undefined"!=typeof self&&null!==self?self.importScripts:void 0)&&(importScripts("release/structure.js"),importScripts("release/input-structure.js")),(InputTree=(new InputStructure).attr({id:"root"})).trackIDs(),(functions={}).getInputTree=function(){return InputTree},isInTheInputTree=function(e){for(;e instanceof InputStructure;){if(e===InputTree)return!0;e=e.parent()}return!1},deserializeIfNeeded=function(e){return e instanceof InputStructure?e:Structure.fromJSON(e)},functions.insert=function(e,t,n){var r,u;if(null!=(u=Structure.instanceWithID(t))&&0<=n&&n<=u.children().length&&isInTheInputTree(u)&&null!=(r=deserializeIfNeeded(e).setup())&&r instanceof InputStructure)return u.insertChild(r,n),r.trackIDs()},functions.delete=function(e){var t;if(null!=(t=Structure.instanceWithID(e))&&isInTheInputTree(t)&&t!==InputTree)return t.removeFromParent(),t.untrackIDs()},functions.replace=function(e,t){var n,r;if(null!=(r=Structure.instanceWithID(e))&&isInTheInputTree(r)&&r!==InputTree&&null!=(n=deserializeIfNeeded(t).setup())&&n instanceof InputStructure)return r.replaceWith(n),r.untrackIDs(),n.trackIDs()},functions.setAttribute=function(e,t,n){var r;if(null!=(r=Structure.instanceWithID(e))&&isInTheInputTree(r)&&("id"===t&&r.untrackIDs(!1),void 0===n?r.clearAttributes(t):r.setAttribute(t,n),"id"===t))return r.trackIDs(!1)},("undefined"!=typeof WorkerGlobalScope&&null!==WorkerGlobalScope||null!=("undefined"!=typeof self&&null!==self?self.importScripts:void 0))&&(expectedArgumentCount={insert:3,delete:1,replace:2,setAttribute:3,getInputTree:0},self.addEventListener("message",function(e){var t,n,r,u,i,s;if(i=e.data,n=i[0],t=2<=i.length?slice.call(i,1):[],expectedArgumentCount[n]===t.length&&("getInputTree"===n?self.postMessage({type:"getInputTree",payload:functions.getInputTree().toJSON()}):functions[n].apply(functions,t)),"sendFeedback"===n)return u=t[0],r=t[1],null!=(null!=(s=Structure.instanceWithID(u))?s.feedback:void 0)?s.feedback(r):self.postMessage("No such Structure: "+u)})),"undefined"!=typeof window&&null!==window&&"undefined"!=typeof EventTarget&&null!==EventTarget&&(Feedback=window.Feedback=new EventTarget),"undefined"!=typeof require&&null!==require&&"undefined"!=typeof exports&&null!==exports&&(EventEmitter=require("events"),(Feedback=exports.Feedback=new EventEmitter).addEventListener=Feedback.addListener),feedback=function(e){var t;return null!=(null!=Feedback?Feedback.dispatchEvent:void 0)?(t=new Event("feedback"),t.payload=e,Feedback.dispatchEvent(t)):null!=(null!=Feedback?Feedback.emit:void 0)?Feedback.emit("feedback",e):null!=("undefined"!=typeof self&&null!==self?self.postMessage:void 0)?self.postMessage({type:"feedback",payload:e}):void 0},Structure.feedback=feedback,"undefined"!=typeof exports&&null!==exports&&(exports.Structure=Structure,exports.InputStructure=InputStructure,exports.insert=functions.insert,exports.delete=functions.delete,exports.replace=functions.replace,exports.setAttribute=functions.setAttribute,exports.getInputTree=functions.getInputTree);
//# sourceMappingURL=lde.js.map
