////////////////////////////////////////////////////////////////////
// Peano Test Proofs
// 

(<<< "Peano Axiom Proofs")

{
  (<<< "Theorem: 1+1=2")
  { (= (+ 1 1) 2) }
  
  (<<< "Proof:")
  {  
    (<<< "Necessary BIHs:")
    { :(= 1 (ðœŽ 0)) :(= (+ 1 1) (+ 1 1)) (= (+ 1 1) (+ 1 (ðœŽ 0))) } <<
    { :(= (+ 1 (ðœŽ 0)) (ðœŽ (+ 1 0))) :(= (+ 1 1) (+ 1 (ðœŽ 0))) 
      (= (+ 1 1) (ðœŽ (+ 1 0)) )
    } <<
    { :(= (+ 1 0) 1) :(= (+ 1 1) (ðœŽ (+ 1 0)) ) (= (+ 1 1) (ðœŽ 1) ) } <<
    { :(= (ðœŽ 1) 2) :(= (+ 1 1) (ðœŽ 1) ) (= (+ 1 1) 2 ) } <<
    { :(= 2 (ðœŽ 1)) :(= 2 2) (= (ðœŽ 1) 2) } <<
    (<<< "the actual proof:") 
    (= (+ 1 1) (+ 1 1))
    (= (+ 1 1) (+ 1 (ðœŽ 0)))
    (= (+ 1 1) (ðœŽ (+ 1 0)) )
    (= (+ 1 1) (ðœŽ 1) )
    (= (+ 1 1) 2 )
  }  
}

{
  (<<< "Theorem 7.2: nâ‰ 0 â‡’ âˆƒm,n=ðœŽ(m)")
  { :(Â¬ (= n 0)) (âˆƒ m, (= n (ðœŽ m))) }

  (<<< "Proof:")
  { :(Â¬ (= n 0))
    (<<< "P(n) is nâ‰ 0â‡’âˆƒk,n=ðœŽ(m)")
    (<<< "Base Case")
    { :(Â¬ (= 0 0))
      { :(Â¬ (âˆƒ m, (= 0 (ðœŽ m))))
        (= 0 0)
        â†’â†
      }
      (âˆƒ m, (= 0 (ðœŽ m)))
    }
    (â‡’ (Â¬ (= 0 0)) (âˆƒ m, (= 0 (ðœŽ m))) )
    (<<< "Inductive step")
    { :[k]
      { :(â‡’ (Â¬ (= k 0)) (âˆƒ m, (= k (ðœŽ m))) )
        { :(Â¬ (= (ðœŽ k) 0)) 
          (= (ðœŽ k) (ðœŽ k))
          (âˆƒ m, (= (ðœŽ k) (ðœŽ m)))
        }
        (â‡’ (Â¬ (= (ðœŽ k) 0)) (âˆƒ m, (= (ðœŽ k) (ðœŽ m))))
      } 
    }
    (<<< "It would be nice to avoid the need for âˆ€ and â‡’ in this proof.")
    (<<< "But (@ P n) only matches expressions")
    (âˆ€ j , (â‡’ (Â¬ (= j 0)) (âˆƒ m, (= j (ðœŽ m)))))
    (â‡’ (Â¬ (= n 0)) (âˆƒ m, (= n (ðœŽ m))))
    (âˆƒ m, (= n (ðœŽ m)))
  }
}

{
  (<<< "Theorem 7.3: nâ‰ ðœŽ(n)")
  { (Â¬ (= n (ðœŽ n))) }

  (<<< "Proof:")
  { 
    (<<< "Base Case:")
    (Â¬ (= 0 (ðœŽ 0)))
    
    (<<< "Inductive step:")
    { :[k]
      { :(Â¬ (= k (ðœŽ k)))
        { :(= (ðœŽ k) (ðœŽ (ðœŽ k)))
          (= k (ðœŽ k))
          â†’â†
        }
        (Â¬ (= (ðœŽ k) (ðœŽ (ðœŽ k))) )
      }
    }
    (âˆ€ j, (Â¬ (= j (ðœŽ j))))
    (Â¬ (= n (ðœŽ n)))
  }
}

{
  (<<< "Theorem 7.4: ðœŽ(n)=n+1")
  { (= (ðœŽ n) (+ n 1)) }

  (<<< "Proof:")
  { 
    (<<< "Necessary BIHs")
    { :(= (+ n 0) n ) :(= (ðœŽ (+ n 0)) (ðœŽ (+ n 0)) ) 
      (= (ðœŽ n) (ðœŽ (+ n 0))) } <<
    { :(= (+ n (ðœŽ 0)) (ðœŽ (+ n 0)) )  :(= (+ n (ðœŽ 0)) (+ n (ðœŽ 0)) )
      (= (ðœŽ (+ n 0)) (+ n (ðœŽ 0)) ) } <<     
    { :(= (ðœŽ (+ n 0)) (+ n (ðœŽ 0)) )  :(= (ðœŽ n) (ðœŽ (+ n 0)))
      (= (ðœŽ n) (+ n (ðœŽ 0))) } <<
    { :(= 1 (ðœŽ 0) ) :(= 1 1) (= (ðœŽ 0) 1 ) } <<  
    { :(= (ðœŽ 0) 1 ) :(= (ðœŽ n) (+ n (ðœŽ 0)))
      (= (ðœŽ n) (+ n 1)) } <<
    (<<< "the actual proof (not needed because the BIHs do all the work)")
    (<<< "(= (ðœŽ n) (ðœŽ (+ n 0)))")
    (<<< "(= (ðœŽ n) (+ n (ðœŽ 0)))")
    (<<< "(= (ðœŽ n) (+ n 1))    ")
  }
}

{
  (<<< "Theorem 7.5: Associativity of Addition")
  { (= (+ (+ m n) p) (+ m (+ n p)) ) }

  (<<< "Proof: (by induction on p for arbitrary m,n")
  { 
    (<<< "Base case:")
    { :(= (+ n 0) n) 
      :(= (+ (+ m n) 0) (+ m n))
      (= (+ (+ m n) 0) (+ m (+ n 0))) 
    } <<
    (<<< "Inductive step:")
    { :[k]
      :(= (+ (+ m n) k) (+ m (+ n k)) )
      { :(= (+ (+ m n) k) (+ m (+ n k)) )
        :(= (+ (+ m n) (ðœŽ k)) (ðœŽ (+ (+ m n) k)))
        (= (+ (+ m n) (ðœŽ k)) (ðœŽ (+ m (+ n k))))
      } <<
      { :(= (+ m (ðœŽ (+ n k))) (ðœŽ (+ m (+ n k))))
        :(= (+ (+ m n) (ðœŽ k)) (ðœŽ (+ m (+ n k))))
        (= (+ (+ m n) (ðœŽ k)) (+ m (ðœŽ (+ n k))))
      } <<
      { :(= (+ n (ðœŽ k)) (ðœŽ (+ n k)))
        :(= (+ (+ m n) (ðœŽ k)) (+ m (ðœŽ (+ n k))))
        (= (+ (+ m n) (ðœŽ k)) (+ m (+ n (ðœŽ k))))
      } <<
    }
    (<<< "Therefore, by induction")
    (âˆ€ p, (= (+ (+ m n) p) (+ m (+ n p)) ))
  }
}
